---
title: "populations"
author: "Georgina Robertson"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Sorting out our 2 populations

Read in the excel sheet and get subsets of pre and post drought populations:
```{r}
library("readxl")
all_isolates<- read_excel("data_sheets/WGS_STB_Populations.xlsx", sheet = 1)

# samples from 1980 an 2001
preDisolates <- all_isolates[all_isolates$COL_YEAR == c(1980,2001), ]
# all the others
postDisolates <- all_isolates[all_isolates$COL_YEAR != c(1980,2001), ]
```

Not everything in the excel sheet made it through to the VCF due to filtering.

Read in list of samples from filtered VCF:
```{r}
sample_names <- read.csv("data_sheets/excl_hamil_cluster.keep", sep = "", header = F)
```

Comparing excel sheet samples data with vcf samples
```{r}
a <- preDisolates[preDisolates$ID %in% sample_names$V1,]
preDsamples <- a$ID

b <- postDisolates[postDisolates$ID %in% sample_names$V1,]
postDsamples <- b$ID
```

We know that some samples are missing from the excel sheet, which are they?
```{r}
c <- c(postDsamples, preDsamples)
missing1 <- setdiff(sample_names$V1, c)

print(missing1)
```
These isolates are not in any of the excel sheets, but I can find them in the PCA and put them in the appropriate groups.
```{r}
# adding samples to
preDsamples <- c(preDsamples, "WAI55_SRR2866532", "WAI56_SRR2866534", "WAI147_SRR2866536",  "WAI324")

c <- c(postDsamples, preDsamples)
missing2 <- setdiff(sample_names$V1, c)
print(missing2)
```
The remaining ones are hard to look for, but they are not in the Hamilton cluster or the pre-drought cluster, so I will assign them to post drought population.

```{r}
postDsamples <- c(postDsamples, "WAI1857", "WAI1881", "WAI1883", "WAI1970D", "WAI2210", "WAI2216", "WAI2911R", "WAI3628b")

# sanity check
c <- c(postDsamples, preDsamples)
setdiff(sample_names$V1, c)
# = 0
```

Write these to file for future use!
```{r}
write(preDsamples, "data_sheets/preDsamples.txt")
write(postDsamples, "data_sheets/postDsamples.txt")
```

